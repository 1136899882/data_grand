preparing examples...
preparing examples...
user config:
    vocab_size : 849423
    kernel_num : 100
    data_cate : word_seg
    lstm_dropout : 0.1
    batch_size : 128
    test_data_path : /data/yujun/datasets/daguanbei_data/test_set.csv
    epochs : 50
    device : 2
    train_data_path : /data/yujun/datasets/daguanbei_data/new_train_set.csv
    lr2 : 0
    linear_hidden_size : 2000
    lstm_layers : 1
    weight_decay : 0
    id : w3
    val_data_path : /data/yujun/datasets/daguanbei_data/val_set.csv
    kernel_sizes : 3,4,5
    max_text_len : 1000
    lr1 : 0.005
    min_lr : 1e-05
    model : LSTM
    embedding_dim : 200
    embedding_path : emb/word_200.txt
    hidden_dim : 256
    env : default
    save_dir : snapshot/
    dropout_rate : 0.5
    label_size : 19
[1, 20] loss: 2.871 | Acc: 8.750%(224/2560)
[1, 40] loss: 2.858 | Acc: 9.199%(471/5120)
[1, 60] loss: 2.833 | Acc: 9.440%(725/7680)
[1, 80] loss: 2.841 | Acc: 9.678%(991/10240)
[1, 100] loss: 2.820 | Acc: 9.875%(1264/12800)
[1, 120] loss: 2.838 | Acc: 9.876%(1517/15360)
[1, 140] loss: 2.807 | Acc: 10.011%(1794/17920)
[1, 160] loss: 2.810 | Acc: 10.122%(2073/20480)
[1, 180] loss: 2.823 | Acc: 10.317%(2377/23040)
[1, 200] loss: 2.806 | Acc: 10.469%(2680/25600)
[1, 220] loss: 2.790 | Acc: 10.671%(3005/28160)
[1, 240] loss: 2.782 | Acc: 10.758%(3305/30720)
[1, 260] loss: 2.774 | Acc: 10.853%(3612/33280)
[1, 280] loss: 2.757 | Acc: 11.004%(3944/35840)
[1, 300] loss: 2.771 | Acc: 11.156%(4284/38400)
[1, 320] loss: 2.778 | Acc: 11.292%(4625/40960)
[1, 340] loss: 2.764 | Acc: 11.372%(4949/43520)
[1, 360] loss: 2.795 | Acc: 11.441%(5272/46080)
[1, 380] loss: 2.766 | Acc: 11.515%(5601/48640)
[1, 400] loss: 2.754 | Acc: 11.553%(5915/51200)
[1, 420] loss: 2.745 | Acc: 11.596%(6234/53760)
[1, 440] loss: 2.777 | Acc: 11.610%(6539/56320)
[1, 460] loss: 2.793 | Acc: 11.637%(6852/58880)
[1, 480] loss: 2.753 | Acc: 11.696%(7186/61440)
[1, 500] loss: 2.760 | Acc: 11.759%(7526/64000)
[1, 520] loss: 2.785 | Acc: 11.780%(7841/66560)
[1, 540] loss: 2.631 | Acc: 11.976%(8278/69120)
[1, 560] loss: 2.531 | Acc: 12.301%(8817/71680)
[1, 580] loss: 2.610 | Acc: 12.491%(9273/74240)
[1, 600] loss: 2.718 | Acc: 12.531%(9624/76800)
[1, 620] loss: 2.760 | Acc: 12.560%(9968/79360)
[1, 640] loss: 2.580 | Acc: 12.690%(10396/81920)
[1, 660] loss: 2.595 | Acc: 12.827%(10836/84480)
[1, 680] loss: 2.609 | Acc: 12.956%(11277/87040)
[1, 700] loss: 2.603 | Acc: 13.096%(11734/89600)
[1, 720] loss: 2.577 | Acc: 13.231%(12194/92160)
[1, 740] loss: 2.567 | Acc: 13.379%(12673/94720)
* Test Acc: 15.526%(885/5700), F1 Score: 0.0790674549778
Best tmp model f1score: 0.0790674549778
[2, 20] loss: 2.495 | Acc: 20.195%(517/2560)
[2, 40] loss: 2.409 | Acc: 21.387%(1095/5120)
[2, 60] loss: 2.398 | Acc: 22.188%(1704/7680)
[2, 80] loss: 2.336 | Acc: 23.154%(2371/10240)
[2, 100] loss: 2.300 | Acc: 23.602%(3021/12800)
[2, 120] loss: 2.294 | Acc: 24.043%(3693/15360)
[2, 140] loss: 2.211 | Acc: 24.570%(4403/17920)
[2, 160] loss: 2.090 | Acc: 25.786%(5281/20480)
[2, 180] loss: 2.029 | Acc: 26.966%(6213/23040)
[2, 200] loss: 2.090 | Acc: 27.727%(7098/25600)
[2, 220] loss: 1.937 | Acc: 28.661%(8071/28160)
[2, 240] loss: 1.859 | Acc: 29.733%(9134/30720)
[2, 260] loss: 1.833 | Acc: 30.595%(10182/33280)
[2, 280] loss: 1.818 | Acc: 31.423%(11262/35840)
[2, 300] loss: 1.807 | Acc: 32.206%(12367/38400)
[2, 320] loss: 1.783 | Acc: 32.942%(13493/40960)
[2, 340] loss: 1.735 | Acc: 33.665%(14651/43520)
[2, 360] loss: 1.694 | Acc: 34.397%(15850/46080)
[2, 380] loss: 1.623 | Acc: 35.212%(17127/48640)
[2, 400] loss: 1.558 | Acc: 36.014%(18439/51200)
[2, 420] loss: 1.578 | Acc: 36.758%(19761/53760)
[2, 440] loss: 1.551 | Acc: 37.504%(21122/56320)
[2, 460] loss: 1.431 | Acc: 38.312%(22558/58880)
[2, 480] loss: 1.527 | Acc: 38.942%(23926/61440)
[2, 500] loss: 1.499 | Acc: 39.520%(25293/64000)
[2, 520] loss: 1.478 | Acc: 40.096%(26688/66560)
[2, 540] loss: 1.401 | Acc: 40.712%(28140/69120)
[2, 560] loss: 1.382 | Acc: 41.338%(29631/71680)
[2, 580] loss: 1.302 | Acc: 41.991%(31174/74240)
[2, 600] loss: 1.318 | Acc: 42.560%(32686/76800)
[2, 620] loss: 1.325 | Acc: 43.136%(34233/79360)
[2, 640] loss: 1.321 | Acc: 43.688%(35789/81920)
[2, 660] loss: 1.308 | Acc: 44.202%(37342/84480)
[2, 680] loss: 1.238 | Acc: 44.760%(38959/87040)
[2, 700] loss: 1.258 | Acc: 45.286%(40576/89600)
[2, 720] loss: 1.205 | Acc: 45.815%(42223/92160)
[2, 740] loss: 1.238 | Acc: 46.319%(43873/94720)
* Test Acc: 60.649%(3457/5700), F1 Score: 0.598859080535
Best tmp model f1score: 0.598859080535
[3, 20] loss: 1.227 | Acc: 65.859%(1686/2560)
[3, 40] loss: 1.179 | Acc: 65.938%(3376/5120)
[3, 60] loss: 1.136 | Acc: 65.938%(5064/7680)
[3, 80] loss: 1.193 | Acc: 65.684%(6726/10240)
[3, 100] loss: 1.137 | Acc: 66.164%(8469/12800)
[3, 120] loss: 1.168 | Acc: 66.178%(10165/15360)
[3, 140] loss: 1.165 | Acc: 66.127%(11850/17920)
[3, 160] loss: 1.152 | Acc: 66.274%(13573/20480)
[3, 180] loss: 1.071 | Acc: 66.558%(15335/23040)
[3, 200] loss: 1.120 | Acc: 66.543%(17035/25600)
[3, 220] loss: 1.094 | Acc: 66.726%(18790/28160)
[3, 240] loss: 1.165 | Acc: 66.742%(20503/30720)
[3, 260] loss: 1.126 | Acc: 66.803%(22232/33280)
[3, 280] loss: 1.076 | Acc: 66.970%(24002/35840)
[3, 300] loss: 1.083 | Acc: 67.060%(25751/38400)
[3, 320] loss: 1.047 | Acc: 67.224%(27535/40960)
[3, 340] loss: 1.084 | Acc: 67.337%(29305/43520)
[3, 360] loss: 1.051 | Acc: 67.461%(31086/46080)
[3, 380] loss: 1.017 | Acc: 67.677%(32918/48640)
[3, 400] loss: 1.088 | Acc: 67.746%(34686/51200)
[3, 420] loss: 1.049 | Acc: 67.883%(36494/53760)
[3, 440] loss: 0.987 | Acc: 68.006%(38301/56320)
[3, 460] loss: 1.005 | Acc: 68.142%(40122/58880)
[3, 480] loss: 0.999 | Acc: 68.250%(41933/61440)
[3, 500] loss: 1.051 | Acc: 68.333%(43733/64000)
[3, 520] loss: 1.017 | Acc: 68.433%(45549/66560)
[3, 540] loss: 1.038 | Acc: 68.508%(47353/69120)
[3, 560] loss: 1.015 | Acc: 68.605%(49176/71680)
[3, 580] loss: 0.975 | Acc: 68.715%(51014/74240)
[3, 600] loss: 0.965 | Acc: 68.841%(52870/76800)
[3, 620] loss: 0.963 | Acc: 68.938%(54709/79360)
[3, 640] loss: 0.980 | Acc: 69.023%(56544/81920)
[3, 660] loss: 0.951 | Acc: 69.156%(58423/84480)
[3, 680] loss: 0.959 | Acc: 69.245%(60271/87040)
[3, 700] loss: 1.011 | Acc: 69.273%(62069/89600)
[3, 720] loss: 1.023 | Acc: 69.333%(63897/92160)
[3, 740] loss: 0.972 | Acc: 69.416%(65751/94720)
* Test Acc: 69.649%(3970/5700), F1 Score: 0.699036202697
Best tmp model f1score: 0.699036202697
[4, 20] loss: 0.985 | Acc: 71.758%(1837/2560)
[4, 40] loss: 0.970 | Acc: 72.109%(3692/5120)
[4, 60] loss: 0.970 | Acc: 71.914%(5523/7680)
[4, 80] loss: 0.894 | Acc: 72.471%(7421/10240)
[4, 100] loss: 0.960 | Acc: 72.516%(9282/12800)
[4, 120] loss: 0.924 | Acc: 72.754%(11175/15360)
[4, 140] loss: 0.982 | Acc: 72.684%(13025/17920)
[4, 160] loss: 0.918 | Acc: 72.822%(14914/20480)
[4, 180] loss: 0.961 | Acc: 72.812%(16776/23040)
[4, 200] loss: 0.961 | Acc: 72.684%(18607/25600)
[4, 220] loss: 0.935 | Acc: 72.699%(20472/28160)
[4, 240] loss: 0.953 | Acc: 72.650%(22318/30720)
[4, 260] loss: 0.910 | Acc: 72.665%(24183/33280)
[4, 280] loss: 0.981 | Acc: 72.628%(26030/35840)
[4, 300] loss: 0.918 | Acc: 72.667%(27904/38400)
[4, 320] loss: 0.922 | Acc: 72.678%(29769/40960)
[4, 340] loss: 0.938 | Acc: 72.695%(31637/43520)
[4, 360] loss: 0.921 | Acc: 72.750%(33523/46080)
[4, 380] loss: 0.892 | Acc: 72.835%(35427/48640)
[4, 400] loss: 0.893 | Acc: 72.908%(37329/51200)
[4, 420] loss: 0.938 | Acc: 72.906%(39194/53760)
[4, 440] loss: 0.908 | Acc: 72.969%(41096/56320)
[4, 460] loss: 0.914 | Acc: 73.030%(43000/58880)
[4, 480] loss: 0.886 | Acc: 73.086%(44904/61440)
[4, 500] loss: 0.912 | Acc: 73.127%(46801/64000)
[4, 520] loss: 0.936 | Acc: 73.125%(48672/66560)
[4, 540] loss: 0.911 | Acc: 73.167%(50573/69120)
[4, 560] loss: 0.893 | Acc: 73.165%(52445/71680)
[4, 580] loss: 0.925 | Acc: 73.198%(54342/74240)
[4, 600] loss: 0.946 | Acc: 73.189%(56209/76800)
[4, 620] loss: 0.929 | Acc: 73.172%(58069/79360)
[4, 640] loss: 0.895 | Acc: 73.207%(59971/81920)
[4, 660] loss: 0.883 | Acc: 73.252%(61883/84480)
[4, 680] loss: 0.869 | Acc: 73.289%(63791/87040)
[4, 700] loss: 0.896 | Acc: 73.318%(65693/89600)
[4, 720] loss: 0.877 | Acc: 73.343%(67593/92160)
[4, 740] loss: 0.918 | Acc: 73.361%(69488/94720)
* Test Acc: 72.491%(4132/5700), F1 Score: 0.725277218502
Best tmp model f1score: 0.725277218502
[5, 20] loss: 0.793 | Acc: 76.602%(1961/2560)
[5, 40] loss: 0.865 | Acc: 76.055%(3894/5120)
[5, 60] loss: 0.874 | Acc: 75.482%(5797/7680)
[5, 80] loss: 0.853 | Acc: 75.469%(7728/10240)
[5, 100] loss: 0.874 | Acc: 75.453%(9658/12800)
[5, 120] loss: 0.840 | Acc: 75.501%(11597/15360)
[5, 140] loss: 0.879 | Acc: 75.374%(13507/17920)
[5, 160] loss: 0.878 | Acc: 75.410%(15444/20480)
[5, 180] loss: 0.827 | Acc: 75.503%(17396/23040)
[5, 200] loss: 0.893 | Acc: 75.414%(19306/25600)
[5, 220] loss: 0.872 | Acc: 75.376%(21226/28160)
[5, 240] loss: 0.832 | Acc: 75.443%(23176/30720)
[5, 260] loss: 0.857 | Acc: 75.412%(25097/33280)
[5, 280] loss: 0.834 | Acc: 75.444%(27039/35840)
[5, 300] loss: 0.852 | Acc: 75.375%(28944/38400)
[5, 320] loss: 0.838 | Acc: 75.359%(30867/40960)
[5, 340] loss: 0.859 | Acc: 75.381%(32806/43520)
[5, 360] loss: 0.847 | Acc: 75.347%(34720/46080)
[5, 380] loss: 0.873 | Acc: 75.306%(36629/48640)
[5, 400] loss: 0.888 | Acc: 75.246%(38526/51200)
[5, 420] loss: 0.853 | Acc: 75.238%(40448/53760)
[5, 440] loss: 0.826 | Acc: 75.266%(42390/56320)
[5, 460] loss: 0.832 | Acc: 75.277%(44323/58880)
[5, 480] loss: 0.868 | Acc: 75.285%(46255/61440)
[5, 500] loss: 0.861 | Acc: 75.277%(48177/64000)
[5, 520] loss: 0.823 | Acc: 75.300%(50120/66560)
[5, 540] loss: 0.856 | Acc: 75.314%(52057/69120)
[5, 560] loss: 0.845 | Acc: 75.317%(53987/71680)
[5, 580] loss: 0.844 | Acc: 75.302%(55904/74240)
[5, 600] loss: 0.851 | Acc: 75.311%(57839/76800)
[5, 620] loss: 0.796 | Acc: 75.370%(59814/79360)
[5, 640] loss: 0.854 | Acc: 75.358%(61733/81920)
[5, 660] loss: 0.801 | Acc: 75.381%(63682/84480)
[5, 680] loss: 0.854 | Acc: 75.400%(65628/87040)
[5, 700] loss: 0.834 | Acc: 75.427%(67583/89600)
[5, 720] loss: 0.883 | Acc: 75.410%(69498/92160)
[5, 740] loss: 0.846 | Acc: 75.379%(71399/94720)
* Test Acc: 73.702%(4201/5700), F1 Score: 0.737109001318
Best tmp model f1score: 0.737109001318
[6, 20] loss: 0.789 | Acc: 75.859%(1942/2560)
[6, 40] loss: 0.788 | Acc: 76.660%(3925/5120)
[6, 60] loss: 0.812 | Acc: 76.458%(5872/7680)
[6, 80] loss: 0.799 | Acc: 76.445%(7828/10240)
[6, 100] loss: 0.854 | Acc: 76.227%(9757/12800)
[6, 120] loss: 0.777 | Acc: 76.517%(11753/15360)
[6, 140] loss: 0.815 | Acc: 76.529%(13714/17920)
[6, 160] loss: 0.761 | Acc: 76.675%(15703/20480)
[6, 180] loss: 0.768 | Acc: 76.675%(17666/23040)
[6, 200] loss: 0.814 | Acc: 76.633%(19618/25600)
[6, 220] loss: 0.742 | Acc: 76.861%(21644/28160)
[6, 240] loss: 0.773 | Acc: 76.937%(23635/30720)
[6, 260] loss: 0.814 | Acc: 76.896%(25591/33280)
[6, 280] loss: 0.818 | Acc: 76.811%(27529/35840)
[6, 300] loss: 0.795 | Acc: 76.810%(29495/38400)
[6, 320] loss: 0.793 | Acc: 76.780%(31449/40960)
[6, 340] loss: 0.812 | Acc: 76.751%(33402/43520)
[6, 360] loss: 0.761 | Acc: 76.821%(35399/46080)
[6, 380] loss: 0.799 | Acc: 76.852%(37381/48640)
[6, 400] loss: 0.817 | Acc: 76.879%(39362/51200)
[6, 420] loss: 0.830 | Acc: 76.840%(41309/53760)
[6, 440] loss: 0.824 | Acc: 76.820%(43265/56320)
[6, 460] loss: 0.842 | Acc: 76.754%(45193/58880)
[6, 480] loss: 0.751 | Acc: 76.807%(47190/61440)
[6, 500] loss: 0.783 | Acc: 76.845%(49181/64000)
[6, 520] loss: 0.795 | Acc: 76.842%(51146/66560)
[6, 540] loss: 0.798 | Acc: 76.839%(53111/69120)
[6, 560] loss: 0.792 | Acc: 76.860%(55093/71680)
[6, 580] loss: 0.839 | Acc: 76.829%(57038/74240)
[6, 600] loss: 0.824 | Acc: 76.811%(58991/76800)
[6, 620] loss: 0.817 | Acc: 76.787%(60938/79360)
[6, 640] loss: 0.824 | Acc: 76.725%(62853/81920)
[6, 660] loss: 0.804 | Acc: 76.746%(64835/84480)
[6, 680] loss: 0.784 | Acc: 76.785%(66834/87040)
[6, 700] loss: 0.800 | Acc: 76.807%(68819/89600)
[6, 720] loss: 0.754 | Acc: 76.846%(70821/92160)
[6, 740] loss: 0.791 | Acc: 76.844%(72787/94720)
* Test Acc: 73.789%(4206/5700), F1 Score: 0.738305237056
Best tmp model f1score: 0.738305237056
[7, 20] loss: 0.766 | Acc: 77.461%(1983/2560)
[7, 40] loss: 0.773 | Acc: 77.227%(3954/5120)
[7, 60] loss: 0.713 | Acc: 77.812%(5976/7680)
[7, 80] loss: 0.748 | Acc: 77.881%(7975/10240)
[7, 100] loss: 0.747 | Acc: 77.914%(9973/12800)
[7, 120] loss: 0.756 | Acc: 77.786%(11948/15360)
[7, 140] loss: 0.704 | Acc: 78.064%(13989/17920)
[7, 160] loss: 0.758 | Acc: 78.101%(15995/20480)
[7, 180] loss: 0.744 | Acc: 78.121%(17999/23040)
[7, 200] loss: 0.781 | Acc: 77.992%(19966/25600)
[7, 220] loss: 0.748 | Acc: 77.990%(21962/28160)
[7, 240] loss: 0.767 | Acc: 77.959%(23949/30720)
[7, 260] loss: 0.756 | Acc: 77.894%(25923/33280)
[7, 280] loss: 0.774 | Acc: 77.838%(27897/35840)
[7, 300] loss: 0.734 | Acc: 77.852%(29895/38400)
[7, 320] loss: 0.721 | Acc: 77.908%(31911/40960)
[7, 340] loss: 0.801 | Acc: 77.824%(33869/43520)
[7, 360] loss: 0.789 | Acc: 77.721%(35814/46080)
[7, 380] loss: 0.757 | Acc: 77.726%(37806/48640)
[7, 400] loss: 0.741 | Acc: 77.740%(39803/51200)
[7, 420] loss: 0.777 | Acc: 77.738%(41792/53760)
[7, 440] loss: 0.726 | Acc: 77.759%(43794/56320)
[7, 460] loss: 0.765 | Acc: 77.773%(45793/58880)
[7, 480] loss: 0.712 | Acc: 77.840%(47825/61440)
[7, 500] loss: 0.757 | Acc: 77.848%(49823/64000)
[7, 520] loss: 0.729 | Acc: 77.861%(51824/66560)
